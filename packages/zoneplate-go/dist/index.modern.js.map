{"version":3,"file":"index.modern.js","sources":["../lib/index.js"],"sourcesContent":["/* global WebAssembly fetch */\n\n// These exported symbols are mutated once the WASM is asynchronously loaded\nexport let renderGo\n\n// tinygo has memory issues...\nconst tiny = false\nconst wasmFile = `/wasm-go/${tiny ? 'tinygo' : 'main'}.wasm`\n\nexport async function importWasm () {\n  if (tiny) {\n    await import('./wasm-go/wasm_exec_tinygo_fixed.js')\n  } else {\n    await import('./wasm-go/wasm_exec_fixed.js')\n  }\n\n  // prevent from running on server for now\n  if (typeof window !== 'undefined') {\n    // console.log('global.Go is a ', typeof window.Go)\n    const go = new window.Go()\n\n    let wasm\n    if ('instantiateStreaming' in WebAssembly) {\n      wasm = await WebAssembly.instantiateStreaming(fetch(wasmFile), go.importObject)\n    } else { // for Safari....\n      const resp = await fetch(wasmFile)\n      const bytes = await resp.arrayBuffer()\n      wasm = await WebAssembly.instantiate(bytes, go.importObject)\n    }\n\n    //  run the go instance\n    go.run(wasm.instance)\n\n    // This is our mutable exported symbol\n    // console.log('window.DrawGo is a ', typeof window.DrawGo)\n    renderGo = window.DrawGo\n\n    console.log('imported Go WASM')\n  } else {\n    console.log('skipped importing Go WASM')\n  }\n}\nimportWasm()\n"],"names":["renderGo","importWasm","window","go","Go","wasm","WebAssembly","instantiateStreaming","fetch","importObject","resp","bytes","arrayBuffer","instantiate","run","instance","DrawGo","console","log"],"mappings":"AAGWA,IAAAA,iBAMWC,IAQpB,gBAJe,iCAIO,oBAAXC,OAAwB,CAEjC,MAAMC,EAAK,IAAID,OAAOE,GAEtB,IAAIC,EACJ,GAAI,yBAA0BC,YAC5BD,QAAaC,YAAYC,qBAAqBC,MAhBlC,sBAgBmDL,EAAGM,kBAC7D,CACL,MAAMC,QAAaF,MAlBP,sBAmBNG,QAAcD,EAAKE,cACzBP,QAAaC,YAAYO,YAAYF,EAAOR,EAAGM,cAIjDN,EAAGW,IAAIT,EAAKU,UAIZf,EAAWE,OAAOc,OAElBC,QAAQC,IAAI,yBAEZD,QAAQC,IAAI,6BAGhBjB"}